(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{368:function(e,a,t){"use strict";t.r(a);var s=t(0),n=Object(s.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"content"},[t("h1",{attrs:{id:"jvm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jvm","aria-hidden":"true"}},[e._v("#")]),e._v(" JVM")]),e._v(" "),t("h2",{attrs:{id:"server-class-machine-detection"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#server-class-machine-detection","aria-hidden":"true"}},[e._v("#")]),e._v(" Server-Class Machine Detection")]),e._v(" "),t("blockquote",[t("p",[e._v('Starting with J2SE 5.0, when an application starts up, the launcher can attempt to detect whether the application is running on a "server-class" machine and, if so, use the Java HotSpot Server Virtual Machine (server VM) instead of the Java HotSpot Client Virtual Machine (client VM). The aim is to improve performance even if no one configures the VM to reflect the application it\'s running. In general, the server VM starts up more slowly than the client VM, but over time runs more quickly.')])]),e._v(" "),t("blockquote",[t("p",[e._v("Note: "),t("strong",[e._v("For Java SE 6, the definition of a server-class machine is one with at least 2 CPUs and at least 2GB of physical memory")]),e._v(".\nIn Java SE 6, server-class detection occurs if "),t("strong",[e._v("neither -server nor -client is specified")]),e._v(" when launching the application on an i586 or Sparc 32-bit machine running Solaris or Linux. As the following table shows, the i586 Microsoft Windows platform uses the client VM by default. The remaining Sun-supported platforms use only the server VM.")])]),e._v(" "),t("h2",{attrs:{id:"about-g1-garbage-collector-permanent-generation-and-metaspace"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#about-g1-garbage-collector-permanent-generation-and-metaspace","aria-hidden":"true"}},[e._v("#")]),e._v(" About G1 Garbage Collector, Permanent Generation and Metaspace")]),e._v(" "),t("p",[e._v("By Poonam-Oracle on Mar 19, 2014")]),e._v(" "),t("p",[e._v("We received some questions around the G1 garbage collector and the use of Permanent Generation with it. There seems to be some confusion that the Hotspot JVM does not use permanent generation when G1 is used as the garbage collector. Hereâ€™s some clarification:")]),e._v(" "),t("ul",[t("li",[e._v("JDK 7: PermGen")])]),e._v(" "),t("p",[e._v("Permanent Generation still exists in JDK 7 and its updates, and is used by all the garbage collectors. In JDK7, the effort to remove the permanent generation was started and some parts of the data residing in the permanent generation were moved to either the Java Heap or to the native heap. Permanent generation was not completely removed and it still exists in JDK 7 and its updates. Here's the list of things that were moved out of the permanent generation in JDK7:")]),e._v(" "),t("p",[e._v("Symbols were moved to the native heap")]),e._v(" "),t("p",[e._v("Interned strings were moved to the Java Heap")]),e._v(" "),t("p",[e._v("Class statics were moved to the Java Heap")]),e._v(" "),t("ul",[t("li",[e._v("JDK7: G1 and PermGen")])]),e._v(" "),t("p",[e._v("With G1 collector, PermGen is collected only at a Full GC which is a stop-the-world (STW) GC. If G1 is running optimally then it does not do Full GCs. G1 invokes the Full GCs only when the PermGen is full or when the application does allocations faster than G1 can concurrently collect garbage.")]),e._v(" "),t("p",[e._v("With CMS garbage collector, we can use option -XX:+CMSClassUnloadingEnabled to collect PermGen space in the CMS concurrent cycle. There is no equivalent option for G1. G1 only collects PermGen during the Full stop-the-world GCs.")]),e._v(" "),t("p",[e._v("We can use options PermSize and MaxPermSize to tune the PermGen space size according to the application needs.")]),e._v(" "),t("ul",[t("li",[e._v("JDK8: PermGen")])]),e._v(" "),t("p",[e._v("Permanent generation has been completely removed in JDK 8. This work has been done under the bug https://bugs.openjdk.java.net/browse/JDK-6964458. Options PermSize and MaxPermSize have also been removed in JDK 8.")]),e._v(" "),t("p",[e._v("Email to openjdk alias regarding the PermGen elimination project: http://mail.openjdk.java.net/pipermail/hotspot-dev/2012-September/006679.html")]),e._v(" "),t("ul",[t("li",[e._v("JDK8: Metaspace")])]),e._v(" "),t("p",[e._v("In JDK 8, classes metadata is now stored in the native heap and this space is called Metaspace. There are some new flags added for Metaspace in JDK 8:")]),e._v(" "),t("ul",[t("li",[e._v("-XX:MetaspaceSize="),t("code",[e._v("<NNN>")]),e._v(" where "),t("code",[e._v("<NNN>")]),e._v(" is the initial amount of space(the initial high-water-mark) allocated for class metadata (in bytes) that may induce a garbage collection to unload classes. The amount is approximate. After the high-water-mark is first reached, the next high-water-mark is managed by the garbage collector")]),e._v(" "),t("li",[e._v("-XX:MaxMetaspaceSize="),t("code",[e._v("<NNN>")]),e._v(" where "),t("code",[e._v("<NNN>")]),e._v(" is the maximum amount of space to be allocated for class metadata (in bytes). This flag can be used to limit the amount of space allocated for class metadata. This value is approximate. By default there is no limit set.")]),e._v(" "),t("li",[e._v("-XX:MinMetaspaceFreeRatio="),t("code",[e._v("<NNN>")]),e._v(" where "),t("code",[e._v("<NNN>")]),e._v(" is the minimum percentage of class metadata capacity free after a GC to avoid an increase in the amount of space (high-water-mark) allocated for class metadata that will induce a garbage collection.")]),e._v(" "),t("li",[e._v("-XX:MaxMetaspaceFreeRatio="),t("code",[e._v("<NNN>")]),e._v(" where "),t("code",[e._v("<NNN>")]),e._v(" is the maximum percentage of class metadata capacity free after a GC to avoid a reduction in the amount of space (high-water-mark) allocated for class metadata that will induce a garbage collection.\nBy default class metadata allocation is only limited by the amount of available native memory. We can use the new option MaxMetaspaceSize to limit the amount of native memory used for the class metadata. It is analogous to MaxPermSize. A garbage collection is induced to collect the dead classloaders and classes when the class metadata usage reaches MetaspaceSize (12Mbytes on the 32bit client VM and 16Mbytes on the 32bit server VM with larger sizes on the 64bit VMs). Set MetaspaceSize to a higher value to delay the induced garbage collections. After an induced garbage collection, the class metadata usage needed to induce the next garbage collection may be increased.")])]),e._v(" "),t("h2",{attrs:{id:"what-is-a-operand-stack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#what-is-a-operand-stack","aria-hidden":"true"}},[e._v("#")]),e._v(" What is a operand stack")]),e._v(" "),t("p",[e._v("It's how the various individual bytecode operations get their input, and how they provide their output.")]),e._v(" "),t("p",[e._v("For instance, consider the iadd operation, which adds two ints together. To use it, you push two values on the stack and then use it:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("iload_0     # Push the value from local variable 0 onto the stack\niload_1     # Push the value from local variable 1 onto the stack\niadd        # Pops those off the stack, adds them, and pushes the result\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])]),t("p",[e._v("Now the top value on the stack is the sum of those two local variables. The next operation might take that top stack value and store it somewhere, or we might push another value on the stack to do something else.")]),e._v(" "),t("p",[e._v("Suppose you want to add three values together. The stack makes that easy:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("iload_0     # Push the value from local variable 0 onto the stack\niload_1     # Push the value from local variable 1 onto the stack\niadd        # Pops those off the stack, adds them, and pushes the result\niload_2     # Push the value from local variable 2 onto the stack\niadd        # Pops those off the stack, adds them, and pushes the result\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br")])]),t("p",[e._v("Now the top value on the stack is the result of adding together those three local variables.")]),e._v(" "),t("p",[e._v("Let's look at that second example in more detail:")]),e._v(" "),t("p",[e._v("We'll assume:")]),e._v(" "),t("ul",[t("li",[e._v("The stack is empty to start with (which is almost never actually true, but we don't care what's on it before we start)")]),e._v(" "),t("li",[e._v("Local variable 0 contains 27")]),e._v(" "),t("li",[e._v("Local variable 1 contains 10")]),e._v(" "),t("li",[e._v("Local variable 2 contains 5\nSo initially:")])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("+-------+\n| stack |\n+-------+\n+-------+\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br")])]),t("p",[e._v("Then we do")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("iload_0     # Push the value from local variable 0 onto the stack\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("Now we have")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("+-------+\n| stack |\n+-------+\n|   27  |\n+-------+\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br")])]),t("p",[e._v("Next")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("iload_1     # Push the value from local variable 1 onto the stack\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("+-------+\n| stack |\n+-------+\n|   10  |\n|   27  |\n+-------+\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br")])]),t("p",[e._v("Now we do the addition:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("iadd        # Pops those off the stack, adds them, and pushes the result\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v('It "pops" the 10 and 27 off the stack, adds them together, and pushes the result (37). Now we have:')]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("+-------+\n| stack |\n+-------+\n|   37  |\n+-------+\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br")])]),t("p",[e._v("Time for our third int:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("iload_2     # Push the value from local variable 2 onto the stack\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("+-------+\n| stack |\n+-------+\n|    5  |\n|   37  |\n+-------+\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br")])]),t("p",[e._v("We do our second iadd:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("iadd        # Pops those off the stack, adds them, and pushes the result\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("That gives us:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("+-------+\n| stack |\n+-------+\n|   42  |\n+-------+\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br")])])])}],!1,null,null,null);n.options.__file="jvm-stack.md";a.default=n.exports}}]);